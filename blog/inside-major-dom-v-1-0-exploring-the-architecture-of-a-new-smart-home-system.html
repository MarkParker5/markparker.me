<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Inside MajorDom v1.0: Exploring the Architecture of a New Smart Home System — Mark Parker</title><meta name="og:title" content="Inside MajorDom v1.0: Exploring the Architecture of a New Smart Home System — Mark Parker"/><meta name="og:image" content="https://markparker.me/articles/inside-major-dom-v-1-0-exploring-the-architecture-of-a-new-smart-home-system/meta.jpg"/><meta name="description" content="Exploring the Architecture of MajorDom v1.0: Dive into the inner workings of MajorDom v1.0. Learn about its core components, fault tolerance and offline capabilities."/><meta name="og:description" content="Exploring the Architecture of MajorDom v1.0: Dive into the inner workings of MajorDom v1.0. Learn about its core components, fault tolerance and offline capabilities."/><meta name="keywords" content="majordom,smarthome,smart home,voice assistant,home automation,smart home system,smart devices,mobile development,backend development,raspberry pi,arduino"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:image" content="https://markparker.me/articles/inside-major-dom-v-1-0-exploring-the-architecture-of-a-new-smart-home-system/meta.jpg"/><meta name="twitter:title" content="Inside MajorDom v1.0: Exploring the Architecture of a New Smart Home System"/><meta name="twitter:description" content="Exploring the Architecture of MajorDom v1.0: Dive into the inner workings of MajorDom v1.0. Learn about its core components, fault tolerance and offline capabilities."/><link rel="stylesheet" href="/highlight/styles/atom-one-light.min.css"/><link rel="stylesheet" href="/highlight/styles/atom-one-dark.min.css" media="(prefers-color-scheme: dark)"/><meta name="next-head-count" content="14"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-MPVB5GN2QR"></script><script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-MPVB5GN2QR');
          </script><link rel="icon" type="image/x-icon" href="/favicon.png"/><link rel="preload" href="/_next/static/css/2108dcfc2251bf4d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2108dcfc2251bf4d.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-fd1bc4a65a80e5c8.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-5aae0466a51ee992.js" defer=""></script><script src="/_next/static/chunks/pages/_app-5d27780da2e99e2e.js" defer=""></script><script src="/_next/static/chunks/403-3a09570af24a91e6.js" defer=""></script><script src="/_next/static/chunks/66-449a15af903a8213.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-7579a99ca14176d4.js" defer=""></script><script src="/_next/static/723DdGZNc6UEB5OzMzczD/_buildManifest.js" defer=""></script><script src="/_next/static/723DdGZNc6UEB5OzMzczD/_ssgManifest.js" defer=""></script></head><body class="text-primary bg-back dark:text-primary-dark dark:bg-back-dark"><div id="__next"><div class="mx-auto" style="max-width:90%;width:44rem"><header><a class="" href="/"><h1 class="text-center block mt-4 mb-1 text-4xl">Mark Parker</h1></a><div class="text-center"><a class="text-link1 hover:text-link1hover underline hover:no-underline" href="/">About</a> · <a class="text-link1 hover:text-link1hover underline hover:no-underline" href="/blog">Blog</a></div></header><hr class="mx-auto w-3/4 h-1px border-t-1 border-faded my-10"/><main><a style="position:fixed;top:0;left:80%;width:50px" target="_blank" rel="noreferrer noopener" href="https://twitter.com/intent/tweet?text=Inside+MajorDom+v1.0%3A+Exploring+the+Architecture+of+a+New+Smart+Home+System&amp;url=https%3A%2F%2Fmarkparker.me%2Fblog%2Finside-major-dom-v-1-0-exploring-the-architecture-of-a-new-smart-home-system&amp;via=MarkParker_5"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 455.731 455.731" xml:space="preserve"> <g> <rect x="0" y="0" style="fill:#333" width="455.731" height="455.731"></rect> <path style="fill:#FFFFFF" d="M60.377,337.822c30.33,19.236,66.308,30.368,104.875,30.368c108.349,0,196.18-87.841,196.18-196.18 c0-2.705-0.057-5.39-0.161-8.067c3.919-3.084,28.157-22.511,34.098-35c0,0-19.683,8.18-38.947,10.107 c-0.038,0-0.085,0.009-0.123,0.009c0,0,0.038-0.019,0.104-0.066c1.775-1.186,26.591-18.079,29.951-38.207 c0,0-13.922,7.431-33.415,13.932c-3.227,1.072-6.605,2.126-10.088,3.103c-12.565-13.41-30.425-21.78-50.25-21.78 c-38.027,0-68.841,30.805-68.841,68.803c0,5.362,0.617,10.581,1.784,15.592c-5.314-0.218-86.237-4.755-141.289-71.423 c0,0-32.902,44.917,19.607,91.105c0,0-15.962-0.636-29.733-8.864c0,0-5.058,54.416,54.407,68.329c0,0-11.701,4.432-30.368,1.272 c0,0,10.439,43.968,63.271,48.077c0,0-41.777,37.74-101.081,28.885L60.377,337.822z"></path> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> <g> </g> </svg></a><a class="text-link1 hover:text-link1hover underline hover:no-underline" href="/">&lt;-<!-- --> Back to home</a><div class="mb-3 mt-1"><h1 class="text-3xl leading-tight font-bold">Inside MajorDom v1.0: Exploring the Architecture of a New Smart Home System</h1><div class="italic mt-1 text-md opacity-50">Published on <!-- -->June 1st, 2023<!-- --> · <!-- -->3 min<!-- --> read</div></div><div class="markdown mb-10"><p>In the previous article, I talked about the origin of the idea to create a new smart home. Now, I want to take a closer look at the architecture of the system.</p>
<p>MajorDom consists of several key components: devices, hub, cloud, bridge, mobile application, and voice assistant.</p>
<p>Devices play a crucial role in the system as they enable control over physical parts of the home. They communicate using radio modules and the “Merlin” protocol that receive commands from the hub, and transmit events back to it.</p>
<p>The hub is the central element of the system. It manages the devices and coordinates their operations. The hub holds the main database with information about users, home, rooms, and devices. Through a local HTTP server and WS server, the hub provides an API for interacting with the database and high-level controlling the devices.</p>
<p>The cloud is the server-side component and plays a vital role in user authentication. It stores the database of users, homes, hubs, and their access rights. Device models with a list of parameters and a firmware update system are also stored in the cloud.</p>
<p>The bridge is a WS server that provides communication between the hub and remote user over the internet. It enables sending commands and receiving information from the hub without being within the home&#x27;s local network.</p>
<p>The system can have multiple bridges located in different places. Clients select the nearest or least loaded bridge to minimize communication delays.</p>
<p>One of the main features of the MajorDom is its fault tolerance. Despite the collapse of one or multiple bridges, the system perseveres and maintains its functionality. The remaining available bridges take on the tasks of the inactive bridges, ensuring uninterrupted data exchange between the hub and clients.</p>
<p>Even a complete loss of internet connection on the hub is not a problem. All the logic and command processing occur locally, ensuring independence from the internet connection and maintaining the ability to control devices within the local network. However, such scenarios are rare since the hub can be simultaneously connected via Wi-Fi and an Ethernet cable, and future support for cellular network will be added.</p>
<p>Smart home control is achieved through a mobile application that provides a user-friendly interface. However, in practice, the role of the mobile application often reduces to system configuration, while day-to-day device management is carried out using automatic scenarios and the voice assistant.</p>
<p>Like the hub, the voice assistant can work completely offline, ensuring security, privacy, and reliability of use.</p>
<p>Most importantly, now anyone, even those without programming experience, can install the MajorDom system. In the next article, I will share a detailed guide on how to do it.</p></div><hr class="mx-auto w-3/4 h-1px border-t-1 border-faded my-10"/><div><div class="text-center mb-10"><a class="text-link2-light hover:text-link2hover-light dark:text-link2-dark dark:hover:text-link2hover-dark font-semibold" target="_blank" rel="noreferrer noopener" href="https://twitter.com/MarkParker_5/status/1664284619909521409">Comment</a> <!-- -->this post on Twitter</div></div><hr class="mx-auto w-3/4 h-1px border-t-1 border-faded my-10"/><div><h4 class="text-l mb-4">Other articles:</h4><div class="mx-auto font-serif"><ul><li class="text-xl mb-8 list-none"><a class="text-link2-light hover:text-link2hover-light dark:text-link2-dark dark:hover:text-link2hover-dark font-semibold" href="/blog/stark-the-voice-assistants-framework">S.T.A.R.K - The First Voice Assistant&#x27;s Framework</a><span class="block text-base italic opacity-50">— <!-- -->September 20th, 2023<!-- --> · <!-- -->2 min<!-- --> read</span><span class="block text-base">I published a framework that allows you to build your own amazing voice assistant.</span></li><li class="text-xl mb-8 list-none"><a class="text-link2-light hover:text-link2hover-light dark:text-link2-dark dark:hover:text-link2hover-dark font-semibold" href="/blog/building-a-smart-home-from-voice-assistant-to-major-dom-v-1-0">Building a Smart Home - from Voice Assistant to MajorDom v1.0</a><span class="block text-base italic opacity-50">— <!-- -->May 26th, 2023<!-- --> · <!-- -->5 min<!-- --> read</span><span class="block text-base">The story of the origin of MajorDom: how I started creating my voice assistant and how it grew into a smart home system.</span></li><li class="text-xl mb-8 list-none"><a class="text-link2-light hover:text-link2hover-light dark:text-link2-dark dark:hover:text-link2hover-dark font-semibold" href="/blog/localize-ios-app-in-5-minutes">How to Localize All Your iOS Apps into 20 Languages in 5 Minutes</a><span class="block text-base italic opacity-50">— <!-- -->March 1st, 2023<!-- --> · <!-- -->3 min<!-- --> read</span><span class="block text-base">I created a console tool that automatically finds all .strings files in an xcode project and translates them into all languages.</span></li></ul></div></div></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"article":{"id":"inside-major-dom-v-1-0-exploring-the-architecture-of-a-new-smart-home-system","date":"2023-06-01","date_pretty":"June 1st, 2023","read_time":"3 min","title":"Inside MajorDom v1.0: Exploring the Architecture of a New Smart Home System","description":"Exploring the Architecture of MajorDom v1.0: Dive into the inner workings of MajorDom v1.0. Learn about its core components, fault tolerance and offline capabilities.","keywords":["majordom","smarthome","smart home","voice assistant","home automation","smart home system","smart devices","mobile development","backend development","raspberry pi","arduino"],"tweetId":"1664284619909521409"},"mdxBody":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.p, {\n      children: \"In the previous article, I talked about the origin of the idea to create a new smart home. Now, I want to take a closer look at the architecture of the system.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"MajorDom consists of several key components: devices, hub, cloud, bridge, mobile application, and voice assistant.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Devices play a crucial role in the system as they enable control over physical parts of the home. They communicate using radio modules and the “Merlin” protocol that receive commands from the hub, and transmit events back to it.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The hub is the central element of the system. It manages the devices and coordinates their operations. The hub holds the main database with information about users, home, rooms, and devices. Through a local HTTP server and WS server, the hub provides an API for interacting with the database and high-level controlling the devices.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The cloud is the server-side component and plays a vital role in user authentication. It stores the database of users, homes, hubs, and their access rights. Device models with a list of parameters and a firmware update system are also stored in the cloud.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The bridge is a WS server that provides communication between the hub and remote user over the internet. It enables sending commands and receiving information from the hub without being within the home's local network.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The system can have multiple bridges located in different places. Clients select the nearest or least loaded bridge to minimize communication delays.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"One of the main features of the MajorDom is its fault tolerance. Despite the collapse of one or multiple bridges, the system perseveres and maintains its functionality. The remaining available bridges take on the tasks of the inactive bridges, ensuring uninterrupted data exchange between the hub and clients.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Even a complete loss of internet connection on the hub is not a problem. All the logic and command processing occur locally, ensuring independence from the internet connection and maintaining the ability to control devices within the local network. However, such scenarios are rare since the hub can be simultaneously connected via Wi-Fi and an Ethernet cable, and future support for cellular network will be added.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Smart home control is achieved through a mobile application that provides a user-friendly interface. However, in practice, the role of the mobile application often reduces to system configuration, while day-to-day device management is carried out using automatic scenarios and the voice assistant.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Like the hub, the voice assistant can work completely offline, ensuring security, privacy, and reliability of use.\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Most importantly, now anyone, even those without programming experience, can install the MajorDom system. In the next article, I will share a detailed guide on how to do it.\"\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"inside-major-dom-v-1-0-exploring-the-architecture-of-a-new-smart-home-system"},"buildId":"723DdGZNc6UEB5OzMzczD","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>